## 模块现有功能说明（v0.1）

### 前端（frontend/）
- 栈：Vite + Vue3 + TypeScript
- 运行方式：`npm run dev`（端口 5173，代理 `/api` 到后端 8080）
- 已实现：
  - 角色列表获取与选择：从 `/api/roles` 拉取并下拉选择。
  - 文本聊天：输入文本 → 调用 `/api/chat` → 展示对话（文本气泡）。
  - 基础录音：使用 MediaRecorder 进行开始/停止录音（当前仅在控制台打印音频 Blob，未上传）。
  - 基础样式：简易对话框、控制区样式、列表分页、页面兼容自适应。
  - 登陆注册：基础token认证（当前仅登陆，登陆任意账号密码均可，非登陆不可对话）
  - 角色个人详情：个人中心、角色详情独立页面（初步）
- 未实现/占位：
  - 语音上传至 ASR 接口与转写结果回填。
  - 语音播放 TTS 返回的音频（当前后端未生成音频 URL）。

### 后端（Go，backend-go/）
- 栈：Go 1.22，标准库 `net/http`，无数据库（内存数据）。
- 运行方式：`go run ./cmd/server`（默认端口 8080）
- 跨域：简单 CORS 允许 `*`（GET/POST/OPTIONS）。
- 路由：
  - `GET /api/health`：健康检查，返回 `ok`。
  - `GET /api/roles`：返回内存角色列表（示例：Sherlock、Mulan）。
  - `GET /api/roles/{id}`：返回指定角色详情。
  - `POST /api/chat`：接收 `{ roleId, text }`，调用模型服务占位生成文本回复，返回 `{ text, audioUrl:null }`。
- 服务占位：
  - `internal/services/model.go`：`GenerateReply` 使用角色 Prompt + 用户文本生成模拟回复（无真实大模型接入）。
  - `internal/services/asr.go`：`TranscribeAudio` 占位，未实现真实转写。
  - `internal/services/tts.go`：`SynthesizeSpeech` 占位，未实现真实合成。
- 数据模型：`internal/models/types.go` 定义 `Role`、`ChatRequest`、`ChatResponse`。
- 构建与容器：提供 `Dockerfile`，可由 `docker-compose` 启动。

### 后端（C++ Stub，backend-cpp/）
- 说明：演示用占位服务，非必须。
- 实现：极简 TCP 服务，端口 `9090`，任何连接返回 `200 ok`（无业务逻辑）。
- 构建：提供 `Dockerfile` 与简单 `CMakeLists.txt`（使用 `asio`）。

### 大模型模块（占位）
- 当前状态：未接入真实大模型服务。
- 行为：Go 后端的 `GenerateReply` 以角色 Prompt 与用户文本拼接，返回 mock 文本。
- 计划：
  - 接入指定大模型（如 Qwen/文心/本地 LLM），封装为独立服务或直接在 Go 内调用 SDK/HTTP API。
  - 角色 Persona：从内存或数据库读取角色设定（Prompt），合并对话上下文生成回复。
  - 性能优化：流式输出、上下文截断与缓存、超时与重试策略。

### 相关规范与运维
- OpenAPI：`api/openapi.yaml` 描述 `/api/roles`、`/api/chat` 等接口。
- 编排：根目录 `docker-compose.yml` 含 `backend-go`、`frontend`、`backend-cpp` 服务。

### 后续建议迭代（简要）
- 前端：
  - ASR 上传与转写回填；TTS 音频播放；角色详情页与收藏；登录/历史记录。
- 后端（Go）：
  - 新增 `POST /api/asr`、`POST /api/tts` 等端点；
  - 接入云厂商或开源 ASR/TTS；
  - 引入数据库存储角色与会话记录；
  - 接入大模型并实现流式回复（Server-Sent Events/WebSocket）。
- 大模型：
  - Persona 设计与 Prompt 模板化；
  - 多角色路由与安全审计；
  - 质量评估与回复一致性优化。


